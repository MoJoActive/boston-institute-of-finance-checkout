"use strict";(self.webpackJsonpCheckout=self.webpackJsonpCheckout||[]).push([[876],{48574:(e,t,s)=>{s.r(t),s.d(t,{default:()=>z});var n=s(86940),i=s(91074),r=s(67627),a=s(19053),o=s(95593),d=s(88870),l=s(49890),u=s(55409),c=s(76741),g=s(74161),m=s(76417),p=s(19686),h=s(92574),_=s(56204),f=s(97204),A=s(24648),b=s(53537),v=s(96543),C=s(34323),y=s(17175),E=s(67570),Z=s(60452),S=s(16206),F=s(78379),k=s(45855),B=s(77683),w=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.state={isResettingAddress:!1},t.addressFormRef=(0,r.createRef)(),t.handleSelectAddress=function(e){return(0,n.__awaiter)(t,void 0,void 0,(function(){var t,s,i,r;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:t=this.props,s=t.updateAddress,i=t.onUnhandledError,this.setState({isResettingAddress:!0}),n.label=1;case 1:return n.trys.push([1,3,4,5]),[4,s(e)];case 2:return n.sent(),[3,5];case 3:return(r=n.sent())instanceof Error&&i(r),[3,5];case 4:return this.setState({isResettingAddress:!1}),[7];case 5:return[2]}}))}))},t.handleUseNewAddress=function(){t.handleSelectAddress({})},t}return(0,n.__extends)(t,e),t.prototype.render=function(){var e=this.props,t=e.googleMapsApiKey,s=e.billingAddress,i=e.countriesWithAutocomplete,o=e.customer,d=o.addresses,l=o.isGuest,u=e.getFields,c=e.countries,g=e.isUpdating,m=e.setFieldValue,p=e.shouldShowOrderComments,_=e.values,v=e.methodId,C=e.isFloatingLabelEnabled,y="amazonpay"===v,w=u(_.countryCode),U=w.filter((function(e){return e.custom})),N=U.length>0,L=y&&N?U:w,M=this.state.isResettingAddress,z=d&&d.length>0,I=s&&(0,f.Z)(s,d,u(s.countryCode));return r.createElement(S.Z,{autoComplete:"on"},y&&s&&r.createElement("div",{className:"form-fieldset"},r.createElement(B.Z,{address:s})),r.createElement(F.Z,{id:"checkoutBillingAddress",ref:this.addressFormRef},z&&!y&&r.createElement(F.Z,{id:"billingAddresses"},r.createElement(k.Z,{isLoading:M},r.createElement(A.Z,{addresses:d,onSelectAddress:this.handleSelectAddress,onUseNewAddress:this.handleUseNewAddress,selectedAddress:I?s:void 0}))),!I&&r.createElement(a.Z,{isLoading:M},r.createElement(b.Z,{countries:c,countriesWithAutocomplete:i,countryCode:_.countryCode,formFields:L.map((function(e){return"firstName"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing First Name"}):"lastName"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing Last Name"}):"address1"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing Address 1"}):"address2"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing Address 2"}):"city"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing City"}):"countryCode"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing Country"}):"stateOrProvinceCode"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing State/Province"}):"postalCode"===e.name?(0,n.__assign)((0,n.__assign)({},e),{label:"Billing Postal Code"}):e})).filter((function(e){return-1===["company","phone"].indexOf(e.name)})),googleMapsApiKey:t,isFloatingLabelEnabled:C,setFieldValue:m,shouldShowSaveAddress:!l}))),p&&r.createElement(E.Z,null),r.createElement("div",{className:"form-actions"},r.createElement(Z.ZP,{disabled:g||M,id:"checkout-billing-continue",isLoading:g||M,type:"submit",variant:Z.Wu.Primary},r.createElement(h.Z,{id:"common.continue_action"}))))},t}(r.PureComponent);const U=(0,_.Z)((0,m.withFormik)({handleSubmit:function(e,t){(0,t.props.onSubmit)(e)},mapPropsToValues:function(e){var t=e.getFields,s=e.customerMessage,i=e.billingAddress;return(0,n.__assign)((0,n.__assign)({},(0,v.Z)(t(i&&i.countryCode),i)),{orderComment:s})},isInitialValid:function(e){var t=e.billingAddress,s=e.getFields,n=e.language;return!!t&&(0,C.Z)({language:n,formFields:s(t.countryCode)}).isValidSync(t)},validationSchema:function(e){var t=e.language,s=e.getFields;return"amazonpay"===e.methodId?(0,p.Vo)((function(e){return(0,y.Z)({translate:(0,C.w)(t),formFields:s(e&&e.countryCode)})})):(0,p.Vo)((function(e){return(0,C.Z)({language:t,formFields:s(e&&e.countryCode)})}))},enableReinitialize:!0})(w));var N=s(41957);function L(e){var t=(0,N.Z)(e);return t&&["amazonpay"].indexOf(t.providerId)>-1?t.providerId:void 0}var M=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.handleSubmit=function(e){return(0,n.__awaiter)(t,void 0,void 0,(function(){var t,s,i,r,a,l,u,c,g,m,p=e.orderComment,h=(0,n.__rest)(e,["orderComment"]);return(0,n.__generator)(this,(function(e){switch(e.label){case 0:t=this.props,s=t.updateAddress,i=t.updateCheckout,r=t.customerMessage,a=t.billingAddress,l=t.navigateNextStep,u=t.onUnhandledError,c=[],(g=(0,o.Z)(h))&&!(0,d.Z)(g,a)&&c.push(s(g)),r!==p&&c.push(i({customerMessage:p})),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,Promise.all(c)];case 2:return e.sent(),l(),[3,4];case 3:return(m=e.sent())instanceof Error&&u(m),[3,4];case 4:return[2]}}))}))},t}return(0,n.__extends)(t,e),t.prototype.componentDidMount=function(){return(0,n.__awaiter)(this,void 0,void 0,(function(){var e,t,s,r,a,o;return(0,n.__generator)(this,(function(n){switch(n.label){case 0:e=this.props,t=e.initialize,s=e.onReady,r=void 0===s?i.noop:s,a=e.onUnhandledError,n.label=1;case 1:return n.trys.push([1,3,,4]),[4,t()];case 2:return n.sent(),r(),[3,4];case 3:return(o=n.sent())instanceof Error&&a(o),[3,4];case 4:return[2]}}))}))},t.prototype.render=function(){var e=this.props,t=e.updateAddress,s=e.isInitializing,i=(0,n.__rest)(e,["updateAddress","isInitializing"]);return r.createElement(a.Z,{isLoading:s},r.createElement("div",{className:"checkout-form"},r.createElement(U,(0,n.__assign)({},i,{onSubmit:this.handleSubmit,updateAddress:t}))))},t}(r.Component);const z=(0,l.Z)((function(e){var t=e.checkoutService,s=e.checkoutState,n=s.data,i=n.getCheckout,r=n.getConfig,a=n.getCart,o=n.getCustomer,d=n.getBillingAddress,l=n.getBillingAddressFields,m=n.getBillingCountries,p=s.statuses,h=p.isLoadingBillingCountries,_=p.isUpdatingBillingAddress,f=p.isUpdatingCheckout,A=r(),b=o(),v=i(),C=a();if(!(A&&b&&v&&C))return null;var y=A.checkoutSettings,E=y.enableOrderComments,Z=y.googleMapsApiKey,S=["US","CA","AU","NZ"];return y.features["CHECKOUT-4183.checkout_google_address_autocomplete_uk"]&&S.push("GB"),{billingAddress:d(),countries:m()||u.L,countriesWithAutocomplete:S,customer:b,customerMessage:v.customerMessage,getFields:l,googleMapsApiKey:Z,initialize:t.loadBillingAddressFields,isInitializing:h(),isUpdating:_()||f(),methodId:L(v),shouldShowOrderComments:E&&(0,g.Z)(C)<1,updateAddress:t.updateBillingAddress,updateCheckout:t.updateCheckout,isFloatingLabelEnabled:(0,c.Z)(A.checkoutSettings)}}))(M)}}]);
//# sourceMappingURL=billing-8f31fd0a.js.map